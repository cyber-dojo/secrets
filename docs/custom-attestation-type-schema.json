{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "array",
  "items": {
    "type": "object",
    "additionalProperties": false,
    "required": [
      "days_since_update",
      "days_to_expiry",
      "expires_at",
      "has_github_secret",
      "has_txt_file",
      "is_secret",
      "name",
      "repo",
      "scope",
      "txt_filename",
      "updated_at"
    ],
    "properties": {
      "days_since_update": {
        "type": [
          "integer",
          "null"
        ],
        "description": "The number of days since the date in the updated_at field"
      },
      "days_to_expiry": {
        "type": "integer",
        "description": "The number of days to expiry, based on the date in the 'expires_at' field"
      },
      "expires_at": {
        "type": "string",
        "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}|never",
        "description": "The date the secret's value expires, as set in its .txt file, or 'never'"
      },
      "has_github_secret": {
        "type": "boolean"
      },
      "has_txt_file": {
        "type": "boolean"
      },
      "is_secret": {
        "type": "boolean"
      },
      "name": {
        "type": "string",
        "description": "The name of the secret, eg KOSLI_API_TOKEN"
      },
      "repo": {
        "type": "string",
        "description": "The name of the repo this secret belongs to if scope==repo"
      },
      "scope": {
        "type": "string",
        "enum": [
          "org",
          "repo"
        ]
      },
      "txt_filename": {
        "type": [
          "string",
          "null"
        ],
        "description": "The path to the .txt file containing information on the secret"
      },
      "updated_at": {
        "type": [
          "string",
          "null"
        ],
        "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}",
        "description": "The date the secret was last updated in GitHub"
      }
    }
  }
}
