secret-name: KOSLI_API_TOKEN
secret-expire: 2026-09-21
is-secret: true

secret-updated: 2025-09-26
secret-updated-by: Lea Milje
secret-type: gh-org

secret-usage:
The KOSLI_API_TOKEN secret actually holds *three* Kosli api-tokens;
one for attestations to https://app.kosli.com, then a comma, then
one for attestations to https://staging.app.kosli.com, then a comma, then
one for attestations to https://app.us.kosli.com 
See https://github.com/kosli-dev/cli/blob/main/cmd/kosli/multiHost.go
In workflows it is used in combination with its partner GitHub Action variable, KOSLI_HOST
which is set to "https://app.kosli.com,https://staging.app.kosli.com,https://app.us.kosli.com"

Update-instructions:
Go to https://app.kosli.com/cyber-dojo/settings/service-accounts
In the ci-pipelines service account, delete the API-token called 'github'.
Create a new API-token, with an expiry-date and description 'github'
Ensure the api-token does not contain a comma.
Make a copy of this "prod" API-token.

Go to https://staging.app.kosli.com/cyber-dojo/settings/service-accounts
In the ci-pipelines service account, delete the API-token called 'github'.
Create a new API-token, with the same expiry-date and description 'github'
Ensure the api-token does not contain a comma.
Make a copy of the "staging" API-token.

Go to https://app.us.kosli.com/cyber-dojo/settings/service-accounts
In the ci-pipelines service account, delete the API-token called 'github'.
Create a new API-token, with the same expiry-date and description 'github'
Ensure the api-token does not contain a comma.
Make a copy of the "staging" API-token.

Prepare the secret's value which must be:
- the "prod" API-token
- a comma
- the "staging" API-token
- a comma
- the "us" API-token

Again, check carefully that neither API-tokens contains a comma.

Go to https://github.com/organizations/cyber-dojo/settings/secrets/actions/KOSLI_API_TOKEN
Click [enter a new value]
Set the new value.
Click [Save changes]